<script>
  const DATA = {{{profilesJSON}}};

  const search = {
    results: [],
    execute(value) {
      const term = value.trim().toLowerCase();

      this.results = term.length < 1 ? [] : DATA.filter(({ name }) => {
        return name.toLowerCase().includes(term);
      });
    }
  };
</script>

<section class="bg-main" x-data="search">
  <div class="x-limit">
    <h2>Find Your Profile</h2>

    <div class="card">
      <div class="split stack y-center">
        <p>
          <strong>Search</strong>
        </p>

        <div>
          <input type="text" placeholder="Name" @input.debounce.500ms="execute($event.target.value)">
        </div>
      </div>
    </div>

    <template x-if="results.length > 0">
      <div class="card">
        <ul>
          <template x-for="profile in results" :key="profile.id">
            <li>
              <a :href="`/profile/${profile.id}`" x-text="profile.name"></a>
            </li>
          </template>
        </ul>
      </div>
    </template>
  </div>
</section>

<section class="bg-dark">
  <div class="x-limit">
    <h2>Global Rankings</h2>

    <div class="split stack">
      <div class="card grow">
        <h3>IATF Premier</h3>

        <ul>
          <li>
            <strong class="no-break">{{premier.count}}</strong>
            <span>profiles</span>
          </li>

          <li>
            <strong class="no-break">{{premier.averageRating}}</strong>
            <span>average Collins Rating</span>
          </li>

          <li>
            <strong class="no-break">{{premier.averageScore}}</strong>
            <span>average score</span>
          </li>
        </ul>

        <p class="text-center">
          <a class="button" href="/premier">View Ranking</a>
        </p>
      </div>

      <div class="card grow">
        <h3>IATF Standard</h3>

        <ul>
          <li>
            <strong class="no-break">{{standard.count}}</strong>
            <span>profiles</span>
          </li>

          <li>
            <strong class="no-break">{{standard.averageRating}}</strong>
            <span>average Collins Rating</span>
          </li>

          <li>
            <strong class="no-break">{{standard.averageScore}}</strong>
            <span>average score</span>
          </li>
        </ul>

        <p class="text-center">
          <a class="button" href="/standard">View Ranking</a>
        </p>
      </div>
    </div>
  </div>
</section>

<section>
  <div class="x-limit">
    <h2>NOTICE</h2>

    <p>This website is still under construction. Only a few profile pages exist right now. All other profiles will be added soon.</p>
  </div>
</section>

<section>
  <div class="x-limit">
    <p>All data on this site is pulled from the official IATF source on a weekly basis.</p>

    <p>
      <span>Total Profile Count:</span>
      <strong class="no-break">{{totalCount}}</strong>
    </p>

    <p>
      <span>Data Last Updated:</span>
      <strong class="no-break">{{timestamp}}</strong>
    </p>
  </div>
</section>